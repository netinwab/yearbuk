I want to implement a Forgot Password feature on the login page for both Viewer and School accounts.
This should use the same secure flow as the in-app password change system already being implemented, but be accessible for users who canâ€™t log in.


---

âš™ï¸ 1ï¸âƒ£ Login Page Update (Frontend)

On the /login page:

Add a small link or text button below the login form:

> â€œForgot your password?â€



When clicked:

Open a small modal OR redirect to a dedicated page: /forgot-password

The form should contain a single input:

Email address

Button: â€œSend Reset Linkâ€





---

ğŸ“§ 2ï¸âƒ£ Request Handling (Backend)

Use the same endpoint as the in-app version: POST /api/auth/request-password-reset

Accept the provided email.

If the email exists in the database, send the password reset email with a secure token.

If it doesnâ€™t exist, still respond with a success message (for security â€” donâ€™t reveal if the email is registered).


Example success message:

> â€œIf this email is associated with a Waibuk account, youâ€™ll receive a password reset link shortly.â€




---

ğŸ“¬ 3ï¸âƒ£ Reset Email (via Resend)

Use the same Resend setup as before, with sandbox mode for now.

Email contents:

Subject: Reset Your Waibuk Password

Body:

> â€œWe received a request to reset your password. Click below to choose a new one.â€



Button: â†’ https://your-domain.com/reset-password/:token


The token and expiration logic are the same as before:

Token valid for 30 minutes

Stored securely (hashed)

One-time use



---

ğŸ”‘ 4ï¸âƒ£ Reset Password Page (Frontend)

Same as the one created in the previous prompt:

URL: /reset-password/:token

Fields:

New Password

Confirm Password


Validate both fields match before sending request.


Submit to: POST /api/auth/reset-password

If successful:

> â€œYour password has been successfully reset! You can now log in with your new password.â€



If invalid/expired:

> â€œThis link has expired or is invalid. Please request another reset link.â€




---

ğŸ’¾ 5ï¸âƒ£ Backend Integration

Use the same backend functions from the previous prompt:

request-password-reset to create token and send email

reset-password to verify and update password


If necessary, make sure these work for both Viewer and School accounts by checking role or table source.


---

ğŸ”’ 6ï¸âƒ£ Security Safeguards

Tokens expire after 30 minutes.

After successful reset, delete or invalidate token.

Send a confirmation email:

> â€œYour Waibuk password was successfully changed. If this wasnâ€™t you, please contact support.â€



All user responses should be generic â€” never reveal whether an email exists.



---

âœ… 7ï¸âƒ£ UX Details

On successful reset, automatically redirect users to /login after 3â€“5 seconds with a success message banner.

Keep design consistent with the rest of your app (use same card style, font, and button design).



---

ğŸ§© Goal: Make it possible for both Viewer and School accounts to recover access securely if they forget their password, using the same backend as the in-app password change system â€” just triggered from the login page.
